<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Sign Up</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap');
  *{box-sizing:border-box}
  body{
    margin:0; min-height:100vh; display:grid; place-items:center; font-family:'Poppins',sans-serif;
    background:linear-gradient(-45deg,#84fab0,#8fd3f4,#fccb90,#d57eeb);
    background-size:400% 400%; animation:bg 10s ease infinite; overflow:hidden;
  }
  @keyframes bg{0%{background-position:0 50%}50%{background-position:100% 50%}100%{background-position:0 50%}}
  .blob{position:absolute;border-radius:50%;filter:blur(36px);opacity:.35;animation:f 13s ease-in-out infinite}
  .b1{width:300px;height:300px;background:#43e97b;top:-70px;left:-70px}
  .b2{width:260px;height:260px;background:#38f9d7;bottom:-60px;right:-60px;animation-delay:2s}
  @keyframes f{0%,100%{transform:translate(0,0)}50%{transform:translate(-16px,20px)}}

  .card{position:relative;width:min(92vw,420px);padding:28px;border-radius:20px;background:rgba(255,255,255,.18);backdrop-filter:blur(14px);box-shadow:0 12px 40px rgba(0,0,0,.18);color:#fff;z-index:1;animation:fade .9s ease}
  @keyframes fade{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}
  h2{text-align:center;margin:6px 0 14px}
  .input{width:100%;padding:12px 14px;border:none;border-radius:14px;background:rgba(255,255,255,.9);color:#1c1c1c;margin:10px 0;outline:none;transition:.2s}
  .input:focus{background:#fff;box-shadow:0 0 0 3px #66a6ff55;transform:translateY(-1px)}
  .hint{font-size:12px;color:#ffffffcc;margin-top:-6px;margin-bottom:8px}
  .btn{width:100%;padding:12px;border:none;border-radius:14px;background:linear-gradient(90deg,#43e97b,#38f9d7);color:#fff;font-weight:700;letter-spacing:.3px;cursor:pointer;transition:.2s}
  .btn:hover{transform:translateY(-1px);box-shadow:0 10px 22px rgba(56,249,215,.35)}
  .btn-primary{background:linear-gradient(90deg,#ff758c,#ff7eb3)}
  .btn-primary:hover{box-shadow:0 10px 22px rgba(255,126,179,.35)}
  .link{display:block;text-align:center;margin-top:10px;color:#fff;text-decoration:none}
  .link:hover{text-decoration:underline}
  .toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%) translateY(20px);background:#10141f;color:#fff;padding:10px 14px;border-radius:12px;box-shadow:0 10px 26px rgba(0,0,0,.25);opacity:0;transition:.25s;z-index:2}
  .toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
  .toast.error{background:#c24141}
  .toast.success{background:#0e8f5b}
</style>
</head>
<body>
<div class="blob b1"></div><div class="blob b2"></div>

<div class="card">
  <h2>Create Account</h2>
  <form id="signupForm" autocomplete="off">
    <input class="input" name="username" placeholder="Enter username" required/>
    <input class="input" type="password" name="password" placeholder="Enter password" required/>
    <input class="input" type="password" name="confirmPassword" placeholder="Confirm password" required/>

    <input class="input" id="phone" name="phone" type="tel" placeholder="Enter mobile number (+91XXXXXXXXXX)" required/>
    <div class="hint">Include country code like +91</div>
    <button class="btn" type="button" id="sendOtpBtn">Send OTP</button>

    <input class="input" name="otp" placeholder="Enter OTP" required/>
    <button class="btn btn-primary" type="submit">Sign Up</button>
  </form>
  <a class="link" href="index.html">Already have an account? Login</a>
</div>

<div id="toast" class="toast">msg</div>

<script>
  const toast = (m,t='success')=>{const x=document.getElementById('toast');x.textContent=m;x.className='toast show '+t;setTimeout(()=>x.className='toast '+t,2000)}

  document.getElementById('sendOtpBtn').addEventListener('click', async ()=>{
    const phone = document.getElementById('phone').value.trim();
    if(!phone.startsWith('+')){ toast('Include country code like +91…','error'); return; }
    try{
      const r = await fetch('/send-otp',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({phone})});
      const d = await r.json().catch(()=>({success:false,message:'Parse error'}));
      if(d.success){ toast(d.message||'OTP sent ✅','success'); } else { toast(d.message||'Failed to send OTP','error'); }
    }catch{ toast('Network error','error'); }
  });

  document.getElementById('signupForm').addEventListener('submit', async (e)=>{
    e.preventDefault();
    const fd = new FormData(e.target);
    const payload = Object.fromEntries(fd.entries());
    if(payload.password !== payload.confirmPassword){ toast('Passwords do not match','error'); return; }
    try{
      const r = await fetch('/signup',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
      const d = await r.json();
      if(d.success){ toast('Signup successful! Redirecting…'); setTimeout(()=>location.href='index.html',900); }
      else { toast(d.message||'Signup failed','error'); }
    }catch{ toast('Network error','error'); }
  });
</script>
</body>
</html>
